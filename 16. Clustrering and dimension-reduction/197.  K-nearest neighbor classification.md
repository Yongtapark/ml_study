- KNN의 개본 개념
- KNN과 K-means의 주요 차이점
---
## The goal of KNN categorization

![197.Pasted image 20241010090940](../pic/16.%20Clustrering%20and%20dimension-reduction/197.Pasted%20image%2020241010090940.png)

	블루팀, 레드팀이 존재하고 여기서 새로운 녹색 원이 들어갈때, 이 새로운 데이터는 블루팀인가? 레드팀인가?
	k=3 새로운 데이터포인트 주변에서 가장 가까운 3개의 데이터를 찾고, 이느 팀에 해당하는 데이터가 많은지 체크. -> k=3일 때는 레드팀, k=5일 때에는 블루팀

	KNN은 기존에 분류되어있는 데이터에서 시작
	K-means는 비 분류된 데이터에서 시작

---
## How KNN works

![197.Pasted image 20241010091924](../pic/16.%20Clustrering%20and%20dimension-reduction/197.Pasted%20image%2020241010091924.png)

	각 데이터 포인트와 새로운 데이터(노란색) 사이의 거리를 계산(유클리드)

![197.Pasted image 20241010092448](../pic/16.%20Clustrering%20and%20dimension-reduction/197.Pasted%20image%2020241010092448.png)

	각 데이터 거리를 그래프로 시각화

![197.Pasted image 20241010131207](../pic/16.%20Clustrering%20and%20dimension-reduction/197.Pasted%20image%2020241010131207.png)

	가장 가까운 데이터 k개를 비교 -> k=3 일때 주황색 2개, 파란색 1개 -> 새로운 데이터는 주황색

---

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy import stats
from sklearn.neighbors import KNeighborsClassifier
```

```python
## create data

nPerClust = 50

# XY centroid locations
A =[1,0]
B =[-1,0]

# generate data
a = [A[0]+np.random.randn(nPerClust),A[1]+np.random.randn(nPerClust)]
b = [B[0]+np.random.randn(nPerClust),B[1]+np.random.randn(nPerClust)]

# concatanate into a list
data = np.transpose(np.concatenate((a,b),axis=1))
grouplabels = np.concatenate((np.zeros(nPerClust),np.ones(nPerClust)))

# group color assignment
groupcolors = 'br'

# show the data
fig,ax = plt.subplots(1)
ax.plot(data[grouplabels==0,0],data[grouplabels==0,1],'ks',markerfacecolor=groupcolors[0])
ax.plot(data[grouplabels==1,0],data[grouplabels==1,1],'ks',markerfacecolor=groupcolors[1])
plt.show()
```
![197.Pasted image 20241010185347](../pic/16.%20Clustrering%20and%20dimension-reduction/197.Pasted%20image%2020241010185347.png)

```python
## compute distance matrix

# initialize
distmat = np.zeros((nPerClust*2,nPerClust*2))

# loop over elements
for i in range(nPerClust*2):
    for j in range(nPerClust*2):
        distmat[i,j] = np.sqrt((data[i,0]-data[j,0])**2 + (data[i,1]-data[j,1])**2)

plt.imshow(distmat,vmax=4)
plt.show()
```
![197.Pasted image 20241010185402](../pic/16.%20Clustrering%20and%20dimension-reduction/197.Pasted%20image%2020241010185402.png)

```python
 ## create the new data point

# ranodm new point
newpoint = 2*np.random.rand(2)-1

# and plot it
ax.plot(newpoint[0],newpoint[1],'ko',markerfacecolor='g',markersize=15)
fig
```
![197.Pasted image 20241010185425](../pic/16.%20Clustrering%20and%20dimension-reduction/197.Pasted%20image%2020241010185425.png)

```python
# compute distance vector
distvec = np.zeros(nPerClust*2)

for i in range(nPerClust*2):
    distvec[i] = np.sqrt((data[i,0]-newpoint[0])**2 + (data[i,1]-newpoint[1])**2)


# show the distances
plt.plot(distvec,'s',markerfacecolor='k')
plt.xlabel('Data element index')
plt.ylabel('Distance to new point')
plt.show()
```
![197.Pasted image 20241010190528](../pic/16.%20Clustrering%20and%20dimension-reduction/197.Pasted%20image%2020241010190528.png)

```python
## now for the labeling

# k parameter
k = 3

# sort the distances
sortidx = np.argsort(distvec)

# find the group assignment of the nearest neighbors
print(grouplabels[sortidx[:k]])
whichgroup = int(np.median(grouplabels[sortidx[:k]]))
print('New data belong to group'+str(whichgroup))

# and re-plot
ax.plot(newpoint[0],newpoint[1],'ko',markerfacecolor='g',markersize=15)
ax.plot(newpoint[0],newpoint[1],'ko',markerfacecolor=groupcolors[whichgroup])
ax.plot(data[sortidx[:k],0],data[sortidx[:k],1],'ko',markersize=10,fillstyle='none')
fig
```

```
[1. 1. 1.]
New data belong to group1
```
![197.Pasted image 20241010190600](../pic/16.%20Clustrering%20and%20dimension-reduction/197.Pasted%20image%2020241010190600.png)

```python
## new using python functions
knn = KNeighborsClassifier(n_neighbors=k,metric='euclidean')
knn.fit(data,grouplabels)

whichgroupP = knn.predict(newpoint.reshape(1,-1))

print('New data belong to group'+str(whichgroupP[0]))
```

```
New data belong to group1.0
```
