- 이진 분류 결과를 설명하는 또 다른 방법
- F-score와 관련된 측정 값들의 공식
- F-score와 d'의 관계
---
## Precision and recall
-정확도와 재현율

![209.Pasted image 20241016122516](../pic/17.%20Signal%20detection%20theory/209.Pasted%20image%2020241016122516.png)
### <span style="color:rgb(236, 158, 111)">Precision</span>  = $\frac{\text{Hits}}{\text{Hits+FA}}$

### <span style="color:rgb(205, 205, 81)">Recall</span> = $\frac{\text{Hits}}{\text{Hits+Miss}}$

---
## F-score

![209.Pasted image 20241016122824](../pic/17.%20Signal%20detection%20theory/209.Pasted%20image%2020241016122824.png)

	적중 수량이 아무리 많더라도 최대 1을 넘을 수 없음
	모든 응답의 수가 일정하면 f-score값은 .5가 나옴

	값이 높을수록 정확도와 재현율이 높다 -> 성능이 좋다

---
## Code

```python
import numpy as np
import matplotlib.pyplot as plt
import scipy.stats as stats
```

```python
## run experiment

# number of 'trials' in the experiment 
N = 50 # actual trials is 2N

# number of experiment repetitions
numExps = 10000

# initialize
Fscores = np.zeros(numExps)
dPrimes = np.zeros(numExps)
specificity = np.zeros(numExps)

### run the experiment!
for expi in range(numExps):

    # generate data
    H = np.random.randint(1,N)  # hits
    M = N-H                     # misses
    CR = np.random.randint(1,N) # correct rejections
    FA = N-CR                   # false alarms

    # Fscore
    Fscores[expi] = H/ (H+(FA+M)/2)

    # specificity(특이도) : correct rejection을 정규화하여 해석
    specificity[expi] = CR/(CR+FA)

    # d'
    dPrimes[expi] = stats.norm.ppf(H/N) - stats.norm.ppf(FA/N)

    # not used here...
    precision = H/(H+FA)
    recall = H/(H+M)
```

```python
## Let's see how they relate to each other!

fig = plt.subplots(1,figsize=(6,6))

plt.scatter(dPrimes,Fscores,s=5,c=specificity)
plt.plot([-4,4],[.5,.5],'k--',linewidth=.5)
plt.plot([0,0],[0,1],linewidth=.5)
plt.xlabel('d-prime')
plt.ylabel('F-score')
plt.title('Correlation = %g'%np.round(np.corrcoef(Fscores,dPrimes)[1,0],3))

plt.show()

# 이는 무작위 데이터이므로, d'는 0에 집중되고, fScore는 .5에 집중된다.
# 보라색 -> 노란색 : 올바른 거부의 수 증가

# d'와 fScore는 높을수록 좋음
```
![209.Pasted image 20241016141029](../pic/17.%20Signal%20detection%20theory/209.Pasted%20image%2020241016141029.png)
